//
// FX Version: fx_5_0
//
// 2 local buffer(s)
//
cbuffer cbUpdateSettings
{
    int     gGridRows;                  // Offset:    0, size:    4
    int     gGridCols;                  // Offset:    4, size:    4
    float   gSpatialStep;               // Offset:    8, size:    4
    float   gHalfWidth;                 // Offset:   12, size:    4
    float   gHalfDepth;                 // Offset:   16, size:    4
    float   gWaveConstants[3];          // Offset:   32, size:   36
}

cbuffer cbDisturbSettings
{
    float   gDisturbMag;                // Offset:    0, size:    4
    int2    gDisturbIndex;              // Offset:    4, size:    8
}

//
// 4 local object(s)
//
Texture2D gPrevSolInput;
Texture2D gCurrSolInput;
RWTexture2D gCurrSolOutput;
RWTexture2D gNextSolOutput;

//
// 1 groups(s)
//
fxgroup
{
    //
    // 2 technique(s)
    //
    technique11 UpdateWaves
    {
        pass P0
        {
            VertexShader = NULL;
            PixelShader = NULL;
            ComputeShader = asm {
                //
                // Generated by Microsoft (R) HLSL Shader Compiler 9.29.952.3111
                //
                //
                // Buffer Definitions: 
                //
                // cbuffer cbUpdateSettings
                // {
                //
                //   int gGridRows;                     // Offset:    0 Size:     4 [unused]
                //   int gGridCols;                     // Offset:    4 Size:     4 [unused]
                //   float gSpatialStep;                // Offset:    8 Size:     4 [unused]
                //   float gHalfWidth;                  // Offset:   12 Size:     4 [unused]
                //   float gHalfDepth;                  // Offset:   16 Size:     4 [unused]
                //   float gWaveConstants[3];           // Offset:   32 Size:    36
                //
                // }
                //
                //
                // Resource Bindings:
                //
                // Name                                 Type  Format         Dim Slot Elements
                // ------------------------------ ---------- ------- ----------- ---- --------
                // gPrevSolInput                     texture  float4          2d    0        1
                // gCurrSolInput                     texture  float4          2d    1        1
                // gNextSolOutput                        UAV   float          2d    0        1
                // cbUpdateSettings                  cbuffer      NA          NA    0        1
                //
                //
                //
                // Input signature:
                //
                // Name                 Index   Mask Register SysValue Format   Used
                // -------------------- ----- ------ -------- -------- ------ ------
                // no Input
                //
                // Output signature:
                //
                // Name                 Index   Mask Register SysValue Format   Used
                // -------------------- ----- ------ -------- -------- ------ ------
                // no Output
                cs_5_0
                dcl_globalFlags refactoringAllowed
                dcl_constantbuffer cb0[5], immediateIndexed
                dcl_resource_texture2d (float,float,float,float) t0
                dcl_resource_texture2d (float,float,float,float) t1
                dcl_uav_typed_texture2d (float,float,float,float) u0
                dcl_input vThreadID.xy
                dcl_temps 3
                dcl_thread_group 16, 16, 1
                
                #line 43 "D:\Data\Books\Book IV\Code\Chapter 12\Blur\FX\WaveSim.fx"
                mov r0.x, vThreadID.x  // x<0:[0,1114094]>
                mov r0.w, vThreadID.y  // y<0:[0,1114094]>
                
                #line 53
                mov r0.yzw, r0.wwww
                mov r1.x, r0.x
                mov r1.y, r0.y
                mov r1.zw, l(0,0,0,0)
                ld_indexable(texture2d)(float,float,float,float) r1.x, r1.xyzw, t0.xyzw
                mul r1.x, r1.x, cb0[2].x
                mov r2.x, r0.x
                mov r2.y, r0.y
                mov r2.zw, l(0,0,0,0)
                ld_indexable(texture2d)(float,float,float,float) r1.y, r2.xyzw, t1.yxzw
                mul r1.y, r1.y, cb0[3].x
                add r1.x, r1.y, r1.x
                iadd r2.y, r0.y, l(1)
                mov r2.x, r0.x
                mov r2.zw, l(0,0,0,0)
                ld_indexable(texture2d)(float,float,float,float) r1.y, r2.xyzw, t1.yxzw
                iadd r2.y, r0.y, l(-1)
                mov r2.x, r0.x
                mov r2.zw, l(0,0,0,0)
                ld_indexable(texture2d)(float,float,float,float) r1.z, r2.xyzw, t1.yzxw
                add r1.y, r1.z, r1.y
                iadd r2.x, r0.x, l(1)
                mov r2.y, r0.y
                mov r2.zw, l(0,0,0,0)
                ld_indexable(texture2d)(float,float,float,float) r1.z, r2.xyzw, t1.yzxw
                add r1.y, r1.z, r1.y
                iadd r2.x, r0.x, l(-1)
                mov r2.y, r0.y
                mov r2.zw, l(0,0,0,0)
                ld_indexable(texture2d)(float,float,float,float) r1.z, r2.xyzw, t1.yzxw
                add r1.y, r1.z, r1.y
                mul r1.y, r1.y, cb0[4].x
                add r1.x, r1.y, r1.x
                store_uav_typed u0.xyzw, r0.xyzw, r1.xxxx  // gNextSolOutput<0>
                
                #line 35
                ret 
                // Approximately 37 instruction slots used
                            
            };
        }

    }

    technique11 DisturbWaves
    {
        pass P0
        {
            VertexShader = NULL;
            PixelShader = NULL;
            ComputeShader = asm {
                //
                // Generated by Microsoft (R) HLSL Shader Compiler 9.29.952.3111
                //
                //
                // Buffer Definitions: 
                //
                // cbuffer cbDisturbSettings
                // {
                //
                //   float gDisturbMag;                 // Offset:    0 Size:     4
                //   int2 gDisturbIndex;                // Offset:    4 Size:     8
                //
                // }
                //
                //
                // Resource Bindings:
                //
                // Name                                 Type  Format         Dim Slot Elements
                // ------------------------------ ---------- ------- ----------- ---- --------
                // gCurrSolOutput                        UAV   float          2d    0        1
                // cbDisturbSettings                 cbuffer      NA          NA    0        1
                //
                //
                //
                // Input signature:
                //
                // Name                 Index   Mask Register SysValue Format   Used
                // -------------------- ----- ------ -------- -------- ------ ------
                // no Input
                //
                // Output signature:
                //
                // Name                 Index   Mask Register SysValue Format   Used
                // -------------------- ----- ------ -------- -------- ------ ------
                // no Output
                cs_5_0
                dcl_globalFlags refactoringAllowed
                dcl_constantbuffer cb0[1], immediateIndexed
                dcl_uav_typed_texture2d (float,float,float,float) u0
                dcl_temps 5
                dcl_thread_group 1, 1, 1
                
                #line 75 "D:\Data\Books\Book IV\Code\Chapter 12\Blur\FX\WaveSim.fx"
                mov r0.x, cb0[0].y  // x<0>
                mov r1.yzw, cb0[0].zzzz  // y<0,0,0>
                mul r2.x, cb0[0].x, l(0.500000)  // halfMag<0:[-1.70141e+038f,1.70141e+038f]>
                
                #line 81
                mov r0.yzw, r1.wwww
                mov r3.x, r0.x
                mov r3.yzw, r0.wwww
                ld_uav_typed_indexable(texture2d)(float,float,float,float) r2.y, r3.xyzw, u0.yxzw  // gCurrSolOutput<0>
                add r2.y, r2.y, cb0[0].x
                store_uav_typed u0.xyzw, r0.xyzw, r2.yyyy  // gCurrSolOutput<0>
                iadd r3.x, r0.x, l(1)
                mov r3.yzw, r0.wwww
                iadd r4.x, r0.x, l(1)
                mov r4.yzw, r0.wwww
                ld_uav_typed_indexable(texture2d)(float,float,float,float) r2.y, r4.xyzw, u0.yxzw  // gCurrSolOutput<0>
                add r2.y, r2.x, r2.y
                store_uav_typed u0.xyzw, r3.xyzw, r2.yyyy  // gCurrSolOutput<0>
                iadd r3.x, r0.x, l(-1)
                mov r3.yzw, r0.wwww
                iadd r1.x, r0.x, l(-1)
                ld_uav_typed_indexable(texture2d)(float,float,float,float) r1.x, r1.xyzw, u0.xyzw  // gCurrSolOutput<0>
                add r1.x, r2.x, r1.x
                store_uav_typed u0.xyzw, r3.xyzw, r1.xxxx  // gCurrSolOutput<0>
                iadd r3.yzw, r1.wwww, l(0, 1, 1, 1)
                mov r3.x, r0.x
                iadd r4.yzw, r1.wwww, l(0, 1, 1, 1)
                mov r4.x, r0.x
                ld_uav_typed_indexable(texture2d)(float,float,float,float) r1.x, r4.xyzw, u0.xyzw  // gCurrSolOutput<0>
                add r1.x, r2.x, r1.x
                store_uav_typed u0.xyzw, r3.xyzw, r1.xxxx  // gCurrSolOutput<0>
                iadd r3.yzw, r1.wwww, l(0, -1, -1, -1)
                mov r3.x, r0.x
                iadd r0.yzw, r1.wwww, l(0, -1, -1, -1)
                ld_uav_typed_indexable(texture2d)(float,float,float,float) r0.x, r0.xyzw, u0.xyzw  // gCurrSolOutput<0>
                add r0.x, r2.x, r0.x
                store_uav_typed u0.xyzw, r3.xyzw, r0.xxxx  // gCurrSolOutput<0>
                
                #line 67
                ret 
                // Approximately 36 instruction slots used
                            
            };
        }

    }

}

